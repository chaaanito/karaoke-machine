import{r as e,t}from"./Peer.svelte-CASFjhdj.js";import{A as n,C as r,D as i,E as a,F as o,I as s,L as c,N as l,O as u,P as d,R as f,_ as p,b as m,c as h,g,h as _,k as v,m as y,p as b,r as x,s as S,t as C,y as w}from"./index-ByCoQqcr.js";var T=()=>addSongModal.showModal(),E=w(`<li class="list-row"><div class="text-4xl font-thin opacity-30 tabular-nums"> </div> <div><img class="size-10 rounded-box" alt="song-cover"/></div> <div class="list-col-grow"><div>Guest</div> <div class="text-xs uppercase font-semibold opacity-60"> </div></div></li>`),D=(e,t)=>t(),O=(e,t)=>t(),k=w(`<div class="card card-side bg-base-100 shadow-sm"><figure class="max-w-50"><img alt="song-cover"/></figure> <div class="card-body flex flex-col justify-between"><h2 class="card-title"> </h2> <div class="card-actions justify-end"><button class="btn btn-sm btn-primary">+ add</button></div></div></div>`),A=w(`<ul class="list bg-base-100 rounded-box shadow-md"><div class="flex flex-row justify-end"><button class="btn btn-xs btn-primary">+ add</button></div> <li class="p-4 pb-2 text-xs opacity-60 tracking-wide">Song Queue</li> <!></ul> <dialog id="addSongModal" class="modal"><div class="modal-box"><form method="dialog"><button class="btn btn-sm btn-circle btn-ghost absolute right-2 top-2">✕</button></form> <h3 class="text-lg font-bold">Queue Song</h3> <div class="w-full flex flex-row justify-between gap-2 items-center"><fieldset class="fieldset w-full"><legend class="fieldset-legend">Youtube URL/Link</legend> <textarea class="textarea h-10 w-full" placeholder="Paste Youtube URL"></textarea> <div class="label">Copy and Paste Youtube URL/Link here.</div></fieldset> <button class="btn btn-primary">Find</button></div> <br/> <!></div></dialog>`,1);function j(t,m){s(m,!0);let x=d(void 0),w=d(null),j=e=>{if(!e)return{};try{let t=new URL(e),n=t.searchParams.get(`v`)||t.pathname.split(`/`).find(e=>e.length===11)||null,r=t.searchParams.get(`list`)||null;return{videoId:n,listId:r}}catch{return{}}},M=async()=>{try{if(!r(x))return;let{videoId:e,listId:t}=j(r(x));if(t&&!e){C.info(`This appears to be a playlist, not a single video.`),l(w,null);return}if(!e)throw Error(`Invalid YouTube link.`);let n=await fetch(`https://noembed.com/embed?url=https://www.youtube.com/watch?v=${e}`);if(!n.ok)throw Error(`Server returned ${n.status}`);let i=await n.json();if(i.error)throw Error(`This video could not be found or isn’t embeddable.`);l(w,{...i,videoId:e,listId:t},!0)}catch(e){l(w,null);let t=`Something went wrong. Please try again.`;e.message.includes(`embeddable`)?t=`This video could not be found or isn’t embeddable.`:e.message.includes(`Invalid YouTube`)?t=`Invalid YouTube link. Please paste a valid URL.`:e.message.includes(`Failed to fetch`)?t=`Network error. Please check your internet connection.`:e.message.includes(`Server returned`)&&(t=`Server error. Please try again later.`),C.error(t),console.error(`❌ NoEmbed error:`,e)}},N=async()=>{e.connection&&e.connection.send({type:`add`,song:{title:r(w).title,cover:r(w).thumbnail_url,videoId:r(w).videoId,metadata:r(w)}})};var P=A(),F=v(P),I=u(F),L=u(I);L.__click=[T],f(I);var R=n(I,4);b(R,17,()=>m.songs,y,(e,t,i)=>{var o=E(),s=u(o),c=u(s,!0);f(s);var l=n(s,2),d=u(l);f(l);var m=n(l,2),_=n(u(m),2),v=u(_,!0);f(_),f(m),f(o),a(e=>{g(c,e),h(d,`src`,r(t).cover),g(v,r(t).title)},[()=>(i+1).toString().padStart(2,`0`)]),p(e,o)}),f(F);var z=n(F,2),B=u(z),V=n(u(B),4),H=u(V),U=n(u(H),2);i(U),c(2),f(H);var W=n(H,2);W.__click=[D,M],f(V);var G=n(V,4),K=e=>{var t=k(),i=u(t),o=u(i);f(i);var s=n(i,2),c=u(s),l=u(c,!0);f(c);var d=n(c,2),m=u(d);m.__click=[O,N],f(d),f(s),f(t),a(()=>{h(o,`src`,r(w).thumbnail_url),g(l,r(w).title)}),p(e,t)};_(G,e=>{r(w)&&e(K)}),f(B),f(z),S(U,()=>r(x),e=>l(x,e)),p(t,P),o()}m([`click`]);var M=w(`<div class="max-w-md mx-auto mt-[2%]"><h1 class="font-bold text-3xl text-right">Karaoke Machine</h1> <div class="tabs tabs-lift"><input type="radio" name="my_tabs_3" class="tab" aria-label="Queue" checked="checked"/> <div class="tab-content bg-base-100 border-base-300 p-6"><!></div> <input type="radio" name="my_tabs_3" class="tab" aria-label="Songbook"/> <div class="tab-content bg-base-100 border-base-300 p-6">Songbook</div></div></div> <dialog id="loadingModal" class="modal"><div class="modal-box"><div class="text-center"><h3 class="text-lg font-bold">Connecting to Host Machine...</h3> <br/> <span class="loading loading-ring loading-xl"></span></div></div></dialog>`,1);function N(r,i){s(i,!0),x(()=>{loadingModal.showModal(),t(i.params.id)});var a=M(),l=v(a),d=n(u(l),2),m=u(d),h=n(m,2),g=u(h);j(g,{get songs(){return e.songs}}),f(h),c(4),f(d),f(l),c(2),p(r,a),o()}export{N as default};